<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="å°¹ç¥ºç¿”">





<title>GoogleNet V1-V4æ¨¡å‹ç¬”è®° | yqxBlog</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
            <!-- MathJaxé…ç½®ï¼Œå¯é€šè¿‡å•ç¾å…ƒç¬¦å·ä¹¦å†™è¡Œå†…å…¬å¼ç­‰ -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
    });
</script>
<!-- ç»™MathJaxå…ƒç´ æ·»åŠ has-jax class -->
<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>
<!-- é€šè¿‡è¿æ¥CDNåŠ è½½MathJaxçš„jsä»£ç  -->
<script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


        
    


<meta name="generator" content="Hexo 5.4.2">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "Â· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "Â· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">BUPTyqx&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">BUPTyqx&#39;s Blog</a><a id="mobile-toggle-theme">Â·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/category">Categories</a>
                
                    <a class="menu-item" href="/tag">Tags</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // ä¸º 6 æ—¶å±•å¼€æ‰€æœ‰
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // è¿™ä¸ªå€¼æ˜¯ç”± tocbot æºç é‡Œå®šä¹‰çš„ scrollSmoothDuration å¾—æ¥çš„
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">GoogleNet V1-V4æ¨¡å‹ç¬”è®°</h1>
            
                <div class="post-meta">
                    
                        ğŸ¦¹â€â™€ï¸ä½œè€…: <a itemprop="author" rel="author" href="/">å°¹ç¥ºç¿”</a><br>
                    

                    
                        <span class="post-time">
                        â²ï¸æ—¶é—´: <a href="#">July 3, 2022&nbsp;&nbsp;11:32:44</a><br>
                        </span>
                    
                    
                        <span class="post-category">
                            ğŸ“’ç›®å½•:
                            
                                <a href="/categories/CVBaseline/">CVBaseline</a><br>
                            
                        </span>
                    
                    
                    
                        <span class="post-count">
                            ğŸ“‘å­—æ•°:
                        <a href="">6,517</a><br>  
                        </span>
                    
                    
                        <span class="post-count">
                    â°é¢„è®¡é˜…è¯»æ—¶é—´:
                        <a href="">30min</a>  
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <h1 id="CVbaseline-GoogleNetç³»åˆ—æ¨¡å‹ç¬”è®°"><a href="#CVbaseline-GoogleNetç³»åˆ—æ¨¡å‹ç¬”è®°" class="headerlink" title="CVbaseline-GoogleNetç³»åˆ—æ¨¡å‹ç¬”è®°"></a>CVbaseline-GoogleNetç³»åˆ—æ¨¡å‹ç¬”è®°</h1><h2 id="1-ç›¸å…³ç ”ç©¶"><a href="#1-ç›¸å…³ç ”ç©¶" class="headerlink" title="1.ç›¸å…³ç ”ç©¶"></a>1.ç›¸å…³ç ”ç©¶</h2><p>1.NIN(Network in Network)ï¼šé¦–ä¸ªé‡‡ç”¨$1\times 1$å·ç§¯çš„å·ç§¯ç¥ç»ç½‘ç»œï¼Œèˆå¼ƒå…¨è¿æ¥å±‚ï¼Œå¤§å¤§å‡å°‘ç½‘ç»œå‚æ•°ã€‚</p>
<p>ç‰¹ç‚¹ï¼š</p>
<ul>
<li>$1\times 1$å·ç§¯</li>
<li>GAPè¾“å‡ºï¼ˆGlobal Average Poolingå…¨å±€å¹³å‡æ± åŒ–ï¼‰</li>
</ul>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220703113521966.png" alt="image-20220703113521966"></p>
<p>2.Robust Object Recognition with Cortex-Like Mechanisms ï¼š<strong>å¤šå°ºåº¦</strong>Gaboræ»¤æ³¢å™¨æå–ç‰¹å¾</p>
<p>ç‰¹ç‚¹ï¼šS1å±‚é‡‡ç”¨8ç§å°ºåº¦Gaboræ»¤æ³¢å™¨è¿›è¡Œæå–ä¸åŒå°ºåº¦ç‰¹å¾</p>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220703113605577.png" alt="image-20220703113605577"></p>
<p>3.Hebbian principleï¼ˆèµ«å¸ƒç†è®ºï¼‰ï¼š</p>
<blockquote>
<p>â€œCells that fire together, wire togetherâ€</p>
<p>(ä¸€èµ·æ¿€å‘çš„ç¥ç»å…ƒè¿æ¥åœ¨ä¸€èµ·)</p>
</blockquote>
<h2 id="2-ç ”ç©¶æˆæœ"><a href="#2-ç ”ç©¶æˆæœ" class="headerlink" title="2.ç ”ç©¶æˆæœ"></a>2.ç ”ç©¶æˆæœ</h2><div class="table-container">
<table>
<thead>
<tr>
<th><strong>æ¨¡å‹</strong></th>
<th><strong>æ—¶é—´</strong></th>
<th><strong>top-5</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>AlexNet</td>
<td>2012</td>
<td>15.3%</td>
</tr>
<tr>
<td>ZFNet</td>
<td>2013</td>
<td>13.5%</td>
</tr>
<tr>
<td>VGG</td>
<td>2014</td>
<td>7.3%</td>
</tr>
<tr>
<td>GoogLeNet</td>
<td>2014</td>
<td>6.6%</td>
</tr>
</tbody>
</table>
</div>
<p><strong>ILSVRC</strong>æˆç»©ï¼š</p>
<ul>
<li>GoogLeNetï¼šåˆ†ç±»ç¬¬ä¸€åï¼Œæ£€æµ‹ç¬¬ä¸€åï¼Œå®šä½ç¬¬äºŒå</li>
<li>VGGï¼šå®šä½ç¬¬ä¸€åï¼Œåˆ†ç±»ç¬¬äºŒå</li>
</ul>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220703113650317.png" alt="image-20220703113650317"></p>
<p><strong>ç ”ç©¶æ„ä¹‰</strong>ï¼š</p>
<ul>
<li>å¼€å¯å¤šå°ºåº¦å·ç§¯æ—¶ä»£</li>
<li>æ‹‰å¼€$1\times 1$å·ç§¯å¹¿æ³›åº”ç”¨åºå¹•</li>
<li>ä¸ºGoogLeNetç³»åˆ—å¼€è¾Ÿé“è·¯</li>
</ul>
<h2 id="3-æ‘˜è¦"><a href="#3-æ‘˜è¦" class="headerlink" title="3.æ‘˜è¦"></a>3.æ‘˜è¦</h2><ul>
<li>æœ¬æ–‡ä¸»é¢˜ï¼šæå‡ºåä¸ºInceptionçš„æ·±åº¦å·ç§¯ç¥ç»ç½‘ç»œï¼Œåœ¨ILSVRC-2014è·å¾—åˆ†ç±»åŠæ£€æµ‹åŒæ–™å† å†›</li>
<li>æ¨¡å‹ç‰¹ç‚¹1ï¼šInceptionç‰¹ç‚¹æ˜¯æé«˜è®¡ç®—èµ„æºåˆ©ç”¨ç‡ï¼Œå¢åŠ ç½‘ç»œæ·±åº¦å’Œå®½åº¦æ—¶ï¼Œå‚æ•°å°‘é‡å¢åŠ </li>
<li>æ¨¡å‹ç‰¹ç‚¹2ï¼šå€Ÿé‰´Hebbainç†è®ºå’Œå¤šå°ºåº¦å¤„ç†</li>
</ul>
<h2 id="4-GoogleNetç»“æ„"><a href="#4-GoogleNetç»“æ„" class="headerlink" title="4.GoogleNetç»“æ„"></a>4.GoogleNetç»“æ„</h2><h3 id="4-1-Inception-module"><a href="#4-1-Inception-module" class="headerlink" title="4.1 Inception module"></a>4.1 Inception module</h3><p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220703114952201.png" alt="image-20220703114952201"></p>
<p>ç‰¹ç‚¹ï¼š</p>
<ul>
<li>å¤šå°ºåº¦ï¼ˆé‡‡ç”¨ä¸åŒå°ºåº¦çš„å·ç§¯æ ¸æå–ç‰¹å¾ï¼Œå¤šä¸ªåˆ†æ”¯è¿›è¡Œå¤„ç†ï¼‰</li>
<li>$1\times1$å·ç§¯é™ç»´ï¼Œä¿¡æ¯èåˆ</li>
<li>$3\times3$max poolingä¿ç•™äº†ç‰¹å¾å›¾æ•°é‡</li>
</ul>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220703114619751.png" alt="image-20220703114619751"></p>
<p>$3\times 3$ pool å¯è®©ç‰¹å¾å›¾é€šé“æ•°å¢åŠ ï¼Œä¸”ç”¨è¾ƒå°‘è®¡ç®—é‡</p>
<ul>
<li>ç¼ºç‚¹ï¼šæ•°æ®é‡ï¼ˆç‰¹å¾å›¾ï¼‰æ¿€å¢ï¼Œè®¡ç®—é‡å¾ˆå¤§</li>
<li>è§£å†³æ–¹æ³•ï¼šå¼•å…¥$1\times 1$å·ç§¯å‹ç¼©<strong>åšåº¦</strong>ï¼ˆè¯•å›¾å‡å°‘å·ç§¯å±‚è¾“å…¥çš„é€šé“æ•°é‡ï¼‰ã€‚</li>
</ul>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220703114648018.png" alt="image-20220703114648018"></p>
<p>Inceptionä»£ç ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Inception</span>(nn.Module):</span><br><span class="line">    __constants__ = [<span class="string">'branch2'</span>, <span class="string">'branch3'</span>, <span class="string">'branch4'</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, in_channels, ch1x1, ch3x3red, ch3x3, ch5x5red, ch5x5, pool_proj,</span></span><br><span class="line"><span class="params">                 conv_block=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(Inception, self).__init__()</span><br><span class="line">        <span class="keyword">if</span> conv_block <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            conv_block = BasicConv2d</span><br><span class="line">        <span class="comment"># å®šä¹‰å››ä¸ªåˆ†æ”¯</span></span><br><span class="line">        <span class="comment"># 1*1</span></span><br><span class="line">        self.branch1 = conv_block(in_channels, ch1x1, kernel_size=<span class="number">1</span>)    <span class="comment"># 1*1</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 3*3</span></span><br><span class="line">        self.branch2 = nn.Sequential(</span><br><span class="line">            conv_block(in_channels, ch3x3red, kernel_size=<span class="number">1</span>),</span><br><span class="line">            conv_block(ch3x3red, ch3x3, kernel_size=<span class="number">3</span>, padding=<span class="number">1</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 5*5 ï¼›  kernel size æ˜¯ 3*3</span></span><br><span class="line">        self.branch3 = nn.Sequential(</span><br><span class="line">            conv_block(in_channels, ch5x5red, kernel_size=<span class="number">1</span>),</span><br><span class="line">            conv_block(ch5x5red, ch5x5, kernel_size=<span class="number">3</span>, padding=<span class="number">1</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="comment"># pool</span></span><br><span class="line">        self.branch4 = nn.Sequential(</span><br><span class="line">            nn.MaxPool2d(kernel_size=<span class="number">3</span>, stride=<span class="number">1</span>, padding=<span class="number">1</span>, ceil_mode=<span class="literal">True</span>),</span><br><span class="line">            conv_block(in_channels, pool_proj, kernel_size=<span class="number">1</span>)</span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        branch1 = self.branch1(x)</span><br><span class="line">        branch2 = self.branch2(x)</span><br><span class="line">        branch3 = self.branch3(x)</span><br><span class="line">        branch4 = self.branch4(x)</span><br><span class="line"></span><br><span class="line">        outputs = [branch1, branch2, branch3, branch4]</span><br><span class="line">        <span class="keyword">return</span> outputs</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        outputs = self._forward(x)</span><br><span class="line">        <span class="comment"># torch.cat(outputs, 1)åœ¨ç¬¬ä¸€ä¸ªç»´åº¦ï¼Œchannelç»´åº¦è¿›è¡Œæ‹¼æ¥</span></span><br><span class="line">        <span class="keyword">return</span> torch.cat(outputs, <span class="number">1</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>åŸºæœ¬å·ç§¯å±‚å®šä¹‰ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">BasicConv2d</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, in_channels, out_channels, **kwargs</span>):</span><br><span class="line">        <span class="built_in">super</span>(BasicConv2d, self).__init__()</span><br><span class="line">        <span class="comment"># nn.Conv2dçš„å·ç§¯</span></span><br><span class="line">        self.conv = nn.Conv2d(in_channels, out_channels, bias=<span class="literal">False</span>, **kwargs)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        x = self.conv(x)</span><br><span class="line">        <span class="keyword">return</span> F.relu(x, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></tbody></table></figure>
<h3 id="4-2-GoogLeNet"><a href="#4-2-GoogLeNet" class="headerlink" title="4.2 GoogLeNet"></a>4.2 GoogLeNet</h3><blockquote>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/ç»˜å›¾96.png" alt="ç»˜å›¾96"></p>
<ul>
<li>è“è‰²ï¼šå·ç§¯</li>
<li>çº¢è‰²ï¼šæ± åŒ–</li>
<li>ç»¿è‰²ï¼šLRN/ç‰¹å¾èåˆ</li>
<li>é»„è‰²ï¼šæ¿€æ´»å‡½æ•°</li>
</ul>
</blockquote>
<p>ä¸‰é˜¶æ®µï¼š</p>
<ul>
<li>conv-pool-conv-pool å¿«é€Ÿé™ä½åˆ†è¾¨ç‡</li>
<li>å †å Inceptionï¼šå †å ä½¿ç”¨Inception Moduleï¼Œè¾¾22å±‚</li>
<li>FCå±‚åˆ†ç±»è¾“å‡º</li>
</ul>
<p>é™„ï¼šå¢åŠ ä¸¤ä¸ªè¾…åŠ©æŸå¤±ï¼ˆå›¾ä¸­ä¸‹éƒ¨çš„ä¸¤ä¸ªç‰¹æ®Šåˆ†æ”¯ï¼‰ï¼Œ<strong>ç¼“è§£æ¢¯åº¦æ¶ˆå¤±</strong>ï¼ˆä¸­é—´å±‚ç‰¹å¾å…·æœ‰åˆ†ç±»èƒ½åŠ›ï¼‰</p>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220703114816712.png" alt="image-20220703114816712"></p>
<blockquote>
<p>ä¸Šé¢çš„ç»“æ„ç‰¹ç‚¹ï¼š5ä¸ªBlockï¼Œ5æ¬¡åˆ†è¾¨ç‡ä¸‹é™ï¼Œå·ç§¯æ ¸æ•°é‡å˜åŒ–é­”å¹»ï¼Œè¾“å‡ºå±‚ä¸º1å±‚FCå±‚ã€‚</p>
</blockquote>
<p>ç½‘ç»œä»£ç ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> namedtuple</span><br><span class="line"><span class="keyword">import</span> torch</span><br><span class="line"><span class="keyword">import</span> torch.nn <span class="keyword">as</span> nn</span><br><span class="line"><span class="keyword">import</span> torch.nn.functional <span class="keyword">as</span> F</span><br><span class="line"><span class="keyword">from</span> torch.jit.annotations <span class="keyword">import</span> <span class="type">Optional</span>, <span class="type">Tuple</span></span><br><span class="line"><span class="keyword">from</span> torch <span class="keyword">import</span> Tensor</span><br><span class="line"></span><br><span class="line">GoogLeNetOutputs = namedtuple(<span class="string">'GoogLeNetOutputs'</span>, [<span class="string">'logits'</span>, <span class="string">'aux_logits2'</span>, <span class="string">'aux_logits1'</span>])</span><br><span class="line">GoogLeNetOutputs.__annotations__ = {<span class="string">'logits'</span>: Tensor, <span class="string">'aux_logits2'</span>: <span class="type">Optional</span>[Tensor],</span><br><span class="line">                                    <span class="string">'aux_logits1'</span>: <span class="type">Optional</span>[Tensor]}</span><br><span class="line">_GoogLeNetOutputs = GoogLeNetOutputs</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç±»å®šä¹‰</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">GoogLeNet</span>(nn.Module):</span><br><span class="line">    __constants__ = [<span class="string">'aux_logits'</span>, <span class="string">'transform_input'</span>]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, num_classes=<span class="number">1000</span>, aux_logits=<span class="literal">True</span>, transform_input=<span class="literal">False</span>, init_weights=<span class="literal">True</span>,</span></span><br><span class="line"><span class="params">                 blocks=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(GoogLeNet, self).__init__()</span><br><span class="line">        <span class="keyword">if</span> blocks <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="comment"># ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶ï¼šå·ç§¯+Inception+Inceptionè¾…åŠ©æŸå¤±</span></span><br><span class="line">            blocks = [BasicConv2d, Inception, InceptionAux]   </span><br><span class="line">            <span class="comment"># å®šä¹‰åŸºæœ¬ç»„ä»¶</span></span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(blocks) == <span class="number">3</span></span><br><span class="line">        </span><br><span class="line">        conv_block = blocks[<span class="number">0</span>]</span><br><span class="line">        inception_block = blocks[<span class="number">1</span>]</span><br><span class="line">        inception_aux_block = blocks[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">        self.aux_logits = aux_logits</span><br><span class="line">        self.transform_input = transform_input</span><br><span class="line">		<span class="comment"># ç¬¬ä¸€é˜¶æ®µ</span></span><br><span class="line">        self.conv1 = conv_block(<span class="number">3</span>, <span class="number">64</span>, kernel_size=<span class="number">7</span>, stride=<span class="number">2</span>, padding=<span class="number">3</span>)</span><br><span class="line">        self.maxpool1 = nn.MaxPool2d(<span class="number">3</span>, stride=<span class="number">2</span>, ceil_mode=<span class="literal">True</span>)</span><br><span class="line">        self.conv2 = conv_block(<span class="number">64</span>, <span class="number">64</span>, kernel_size=<span class="number">1</span>)</span><br><span class="line">        self.conv3 = conv_block(<span class="number">64</span>, <span class="number">192</span>, kernel_size=<span class="number">3</span>, padding=<span class="number">1</span>)</span><br><span class="line">        self.maxpool2 = nn.MaxPool2d(<span class="number">3</span>, stride=<span class="number">2</span>, ceil_mode=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># ç¬¬äºŒé˜¶æ®µ</span></span><br><span class="line">        self.inception3a = inception_block(<span class="number">192</span>, <span class="number">64</span>, <span class="number">96</span>, <span class="number">128</span>, <span class="number">16</span>, <span class="number">32</span>, <span class="number">32</span>)</span><br><span class="line">        self.inception3b = inception_block(<span class="number">256</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">192</span>, <span class="number">32</span>, <span class="number">96</span>, <span class="number">64</span>)</span><br><span class="line">        self.maxpool3 = nn.MaxPool2d(<span class="number">3</span>, stride=<span class="number">2</span>, ceil_mode=<span class="literal">True</span>)</span><br><span class="line">		<span class="comment"># ç¬¬ä¸‰é˜¶æ®µ</span></span><br><span class="line">        self.inception4a = inception_block(<span class="number">480</span>, <span class="number">192</span>, <span class="number">96</span>, <span class="number">208</span>, <span class="number">16</span>, <span class="number">48</span>, <span class="number">64</span>)</span><br><span class="line">        self.inception4b = inception_block(<span class="number">512</span>, <span class="number">160</span>, <span class="number">112</span>, <span class="number">224</span>, <span class="number">24</span>, <span class="number">64</span>, <span class="number">64</span>)</span><br><span class="line">        self.inception4c = inception_block(<span class="number">512</span>, <span class="number">128</span>, <span class="number">128</span>, <span class="number">256</span>, <span class="number">24</span>, <span class="number">64</span>, <span class="number">64</span>)</span><br><span class="line">        self.inception4d = inception_block(<span class="number">512</span>, <span class="number">112</span>, <span class="number">144</span>, <span class="number">288</span>, <span class="number">32</span>, <span class="number">64</span>, <span class="number">64</span>)</span><br><span class="line">        self.inception4e = inception_block(<span class="number">528</span>, <span class="number">256</span>, <span class="number">160</span>, <span class="number">320</span>, <span class="number">32</span>, <span class="number">128</span>, <span class="number">128</span>)</span><br><span class="line">        self.maxpool4 = nn.MaxPool2d(<span class="number">2</span>, stride=<span class="number">2</span>, ceil_mode=<span class="literal">True</span>)</span><br><span class="line">		<span class="comment"># ç¬¬å››é˜¶æ®µ</span></span><br><span class="line">        self.inception5a = inception_block(<span class="number">832</span>, <span class="number">256</span>, <span class="number">160</span>, <span class="number">320</span>, <span class="number">32</span>, <span class="number">128</span>, <span class="number">128</span>)</span><br><span class="line">        self.inception5b = inception_block(<span class="number">832</span>, <span class="number">384</span>, <span class="number">192</span>, <span class="number">384</span>, <span class="number">48</span>, <span class="number">128</span>, <span class="number">128</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> aux_logits:</span><br><span class="line">            self.aux1 = inception_aux_block(<span class="number">512</span>, num_classes)</span><br><span class="line">            self.aux2 = inception_aux_block(<span class="number">528</span>, num_classes)</span><br><span class="line">		<span class="comment"># ç¬¬äº”é˜¶æ®µ</span></span><br><span class="line">        self.avgpool = nn.AdaptiveAvgPool2d((<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">        self.dropout = nn.Dropout(<span class="number">0.2</span>)                     <span class="comment"># 0.4 å˜ä¸º 0.2</span></span><br><span class="line">        self.fc = nn.Linear(<span class="number">1024</span>, num_classes)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> init_weights:</span><br><span class="line">            self._initialize_weights()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_initialize_weights</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">for</span> m <span class="keyword">in</span> self.modules():</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">isinstance</span>(m, nn.Conv2d) <span class="keyword">or</span> <span class="built_in">isinstance</span>(m, nn.Linear):</span><br><span class="line">                <span class="keyword">import</span> scipy.stats <span class="keyword">as</span> stats</span><br><span class="line">                X = stats.truncnorm(-<span class="number">2</span>, <span class="number">2</span>, scale=<span class="number">0.01</span>)</span><br><span class="line">                values = torch.as_tensor(X.rvs(m.weight.numel()), dtype=m.weight.dtype)</span><br><span class="line">                values = values.view(m.weight.size())</span><br><span class="line">                <span class="keyword">with</span> torch.no_grad():</span><br><span class="line">                    m.weight.copy_(values)</span><br><span class="line">            <span class="keyword">elif</span> <span class="built_in">isinstance</span>(m, nn.BatchNorm2d):</span><br><span class="line">                nn.init.constant_(m.weight, <span class="number">1</span>)</span><br><span class="line">                nn.init.constant_(m.bias, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_transform_input</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="comment"># type: (Tensor) -&gt; Tensor</span></span><br><span class="line">        <span class="keyword">if</span> self.transform_input:</span><br><span class="line">            x_ch0 = torch.unsqueeze(x[:, <span class="number">0</span>], <span class="number">1</span>) * (<span class="number">0.229</span> / <span class="number">0.5</span>) + (<span class="number">0.485</span> - <span class="number">0.5</span>) / <span class="number">0.5</span></span><br><span class="line">            x_ch1 = torch.unsqueeze(x[:, <span class="number">1</span>], <span class="number">1</span>) * (<span class="number">0.224</span> / <span class="number">0.5</span>) + (<span class="number">0.456</span> - <span class="number">0.5</span>) / <span class="number">0.5</span></span><br><span class="line">            x_ch2 = torch.unsqueeze(x[:, <span class="number">2</span>], <span class="number">1</span>) * (<span class="number">0.225</span> / <span class="number">0.5</span>) + (<span class="number">0.406</span> - <span class="number">0.5</span>) / <span class="number">0.5</span></span><br><span class="line">            x = torch.cat((x_ch0, x_ch1, x_ch2), <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="comment"># type: (Tensor) -&gt; <span class="type">Tuple</span>[Tensor, <span class="type">Optional</span>[Tensor], <span class="type">Optional</span>[Tensor]]</span></span><br><span class="line">        <span class="comment"># N x 3 x 224 x 224</span></span><br><span class="line">        x = self.conv1(x)</span><br><span class="line">        <span class="comment"># N x 64 x 112 x 112</span></span><br><span class="line">        x = self.maxpool1(x)</span><br><span class="line">        <span class="comment"># N x 64 x 56 x 56</span></span><br><span class="line">        x = self.conv2(x)</span><br><span class="line">        <span class="comment"># N x 64 x 56 x 56</span></span><br><span class="line">        x = self.conv3(x)</span><br><span class="line">        <span class="comment"># N x 192 x 56 x 56</span></span><br><span class="line">        x = self.maxpool2(x)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># N x 192 x 28 x 28</span></span><br><span class="line">        x = self.inception3a(x)</span><br><span class="line">        <span class="comment"># N x 256 x 28 x 28</span></span><br><span class="line">        x = self.inception3b(x)</span><br><span class="line">        <span class="comment"># N x 480 x 28 x 28</span></span><br><span class="line">        x = self.maxpool3(x)</span><br><span class="line">        <span class="comment"># N x 480 x 14 x 14</span></span><br><span class="line">        x = self.inception4a(x)</span><br><span class="line">        <span class="comment"># N x 512 x 14 x 14</span></span><br><span class="line">        <span class="comment"># åªæœ‰åœ¨è®­ç»ƒé˜¶æ®µæ‰è¿›è¡Œè¾…åŠ©æŸå¤±</span></span><br><span class="line">        aux_defined = self.training <span class="keyword">and</span> self.aux_logits</span><br><span class="line">        <span class="comment"># å®šä¹‰è¾…åŠ©æŸå¤±</span></span><br><span class="line">        <span class="keyword">if</span> aux_defined:</span><br><span class="line">            aux1 = self.aux1(x)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            aux1 = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        x = self.inception4b(x)</span><br><span class="line">        <span class="comment"># N x 512 x 14 x 14</span></span><br><span class="line">        x = self.inception4c(x)</span><br><span class="line">        <span class="comment"># N x 512 x 14 x 14</span></span><br><span class="line">        x = self.inception4d(x)</span><br><span class="line">        <span class="comment"># N x 528 x 14 x 14</span></span><br><span class="line">        <span class="comment"># æ˜¯å¦è¿›è¡Œè¾…åŠ©æŸå¤±</span></span><br><span class="line">        <span class="keyword">if</span> aux_defined:</span><br><span class="line">            aux2 = self.aux2(x)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            aux2 = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        x = self.inception4e(x)</span><br><span class="line">        <span class="comment"># N x 832 x 14 x 14</span></span><br><span class="line">        x = self.maxpool4(x)</span><br><span class="line">        <span class="comment"># N x 832 x 7 x 7</span></span><br><span class="line">        x = self.inception5a(x)</span><br><span class="line">        <span class="comment"># N x 832 x 7 x 7</span></span><br><span class="line">        x = self.inception5b(x)</span><br><span class="line">        <span class="comment"># N x 1024 x 7 x 7</span></span><br><span class="line"></span><br><span class="line">        x = self.avgpool(x)</span><br><span class="line">        <span class="comment"># N x 1024 x 1 x 1</span></span><br><span class="line">        x = torch.flatten(x, <span class="number">1</span>)</span><br><span class="line">        <span class="comment"># N x 1024</span></span><br><span class="line">        x = self.dropout(x)</span><br><span class="line">        x = self.fc(x)</span><br><span class="line">        <span class="comment"># N x 1000 (num_classes)</span></span><br><span class="line">        <span class="keyword">return</span> x, aux2, aux1</span><br><span class="line"></span><br><span class="line"><span class="meta">    @torch.jit.unused</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">eager_outputs</span>(<span class="params">self, x, aux2, aux1</span>):</span><br><span class="line">        <span class="comment"># type: (Tensor, <span class="type">Optional</span>[Tensor], <span class="type">Optional</span>[Tensor]) -&gt; GoogLeNetOutputs</span></span><br><span class="line">        <span class="keyword">if</span> self.training <span class="keyword">and</span> self.aux_logits:</span><br><span class="line">            <span class="keyword">return</span> _GoogLeNetOutputs(x, aux2, aux1)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="comment"># type: (Tensor) -&gt; GoogLeNetOutputs</span></span><br><span class="line">        x = self._transform_input(x)        <span class="comment"># é‡Œé¢ä¼šåˆ¤æ–­æ˜¯å¦éœ€è¦transform</span></span><br><span class="line">        x, aux1, aux2 = self._forward(x)    <span class="comment"># æ­£å¼forwaord</span></span><br><span class="line">        aux_defined = self.training <span class="keyword">and</span> self.aux_logits</span><br><span class="line">        <span class="keyword">if</span> torch.jit.is_scripting():</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> aux_defined:</span><br><span class="line">                warnings.warn(<span class="string">"Scripted GoogleNet always returns GoogleNetOutputs Tuple"</span>)</span><br><span class="line">            <span class="keyword">return</span> GoogLeNetOutputs(x, aux2, aux1)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> self.eager_outputs(x, aux2, aux1)</span><br></pre></td></tr></tbody></table></figure>
<h2 id="5-è®­ç»ƒæŠ€å·§"><a href="#5-è®­ç»ƒæŠ€å·§" class="headerlink" title="5.è®­ç»ƒæŠ€å·§"></a>5.è®­ç»ƒæŠ€å·§</h2><p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220704014209401.png" alt="image-20220704014209401"></p>
<p>1.<strong>è¾…åŠ©æŸå¤±</strong>ï¼šåœ¨Inception4bå’ŒInception4eå¢åŠ ä¸¤ä¸ªè¾…åŠ©åˆ†ç±»å±‚ï¼Œç”¨äºè®¡ç®—è¾…åŠ©æŸå¤±ï¼Œè¾¾åˆ°ï¼š</p>
<ul>
<li><p>å¢åŠ <strong>losså›ä¼ </strong></p>
</li>
<li><p>å……å½“<strong>æ­£åˆ™çº¦æŸ</strong>ï¼Œè¿«ä½¿ä¸­é—´å±‚ç‰¹å¾ä¹Ÿèƒ½å…·å¤‡åˆ†ç±»èƒ½åŠ›</p>
</li>
</ul>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220703121824604.png" alt="image-20220703121824604"></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¾…åŠ©æŸå¤±å®šä¹‰ 4a 4d</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">InceptionAux</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, in_channels, num_classes, conv_block=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(InceptionAux, self).__init__()</span><br><span class="line">        <span class="keyword">if</span> conv_block <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            conv_block = BasicConv2d</span><br><span class="line">        self.conv = conv_block(in_channels, <span class="number">128</span>, kernel_size=<span class="number">1</span>)</span><br><span class="line">        self.fc1 = nn.Linear(<span class="number">2048</span>, <span class="number">1024</span>)</span><br><span class="line">        self.fc2 = nn.Linear(<span class="number">1024</span>, num_classes)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        <span class="comment"># aux1: N x 512 x 14 x 14, aux2: N x 528 x 14 x 14</span></span><br><span class="line">        x = F.adaptive_avg_pool2d(x, (<span class="number">4</span>, <span class="number">4</span>)) <span class="comment"># æ± åŒ–</span></span><br><span class="line">        <span class="comment"># aux1: N x 512 x 4 x 4, aux2: N x 528 x 4 x 4</span></span><br><span class="line">        x = self.conv(x)</span><br><span class="line">        <span class="comment"># N x 128 x 4 x 4</span></span><br><span class="line">        x = torch.flatten(x, <span class="number">1</span>)</span><br><span class="line">        <span class="comment"># N x 2048</span></span><br><span class="line">        x = F.relu(self.fc1(x), inplace=<span class="literal">True</span>)</span><br><span class="line">        <span class="comment"># N x 1024</span></span><br><span class="line">        x = F.dropout(x, <span class="number">0.7</span>, training=self.training)</span><br><span class="line">        <span class="comment"># N x 1024</span></span><br><span class="line">        x = self.fc2(x)</span><br><span class="line">        <span class="comment"># N x 1000 (num_classes)</span></span><br><span class="line">        <span class="keyword">return</span> x</span><br></pre></td></tr></tbody></table></figure>
<p>2.<strong>å­¦ä¹ ç‡ä¸‹é™ç­–ç•¥</strong>ï¼šæ¯8ä¸ªepochä¸‹é™4%ï¼šfixed learning rate schedule (decreasing the learning rate by 4% every 8 epochsï¼‰$0.96^{100 }= 0.016$ï¼Œ 800ä¸ªepochsï¼Œæ‰ä¸‹é™ä¸åˆ°100å€ã€‚</p>
<p>3.<strong>æ•°æ®å¢å¼º</strong>ï¼šæŒ‡å¯¼æ–¹é’ˆå¦‚ä¸‹ï¼š</p>
<ul>
<li>å›¾åƒå°ºå¯¸å‡åŒ€åˆ†å¸ƒåœ¨8%-100%â€‹ä¹‹é—´ï¼Œè¿›è¡Œéšæœºè£å‰ªã€‚</li>
<li>é•¿å®½æ¯”åœ¨$[3/4,  4/3]$ä¹‹é—´</li>
<li>å…‰åº¦ç•¸å˜å¯ä»¥å‡è½»è¿‡æ‹Ÿåˆï¼ŒPhotometric distortions æœ‰æ•ˆï¼Œå¦‚äº®åº¦ã€é¥±å’Œåº¦å’Œå¯¹æ¯”åº¦ç­‰</li>
</ul>
<h2 id="6-æµ‹è¯•æŠ€å·§"><a href="#6-æµ‹è¯•æŠ€å·§" class="headerlink" title="6.æµ‹è¯•æŠ€å·§"></a>6.æµ‹è¯•æŠ€å·§</h2><p><strong>1.</strong> <strong>Multi crop</strong>ï¼š1å¼ å›¾å˜144å¼ å›¾</p>
<blockquote>
<ul>
<li>Step1: ç­‰æ¯”ä¾‹ç¼©æ”¾çŸ­è¾¹è‡³256, 288, 320, 352ï¼Œå››ç§å°ºå¯¸ã€‚ <strong>ä¸€åˆ†ä¸ºå››</strong></li>
<li>Step2:  åœ¨é•¿è¾¹ä¸Šè£å‰ªå‡º3ä¸ªæ­£æ–¹å½¢ï¼Œå·¦ä¸­å³æˆ–è€…ä¸Šä¸­ä¸‹ï¼Œä¸‰ä¸ªä½ç½®ã€‚ <strong>ä¸€åˆ†ä¸ºä¸‰</strong></li>
<li>Step3: å·¦ä¸Šï¼Œå³ä¸Šï¼Œå·¦ä¸‹ï¼Œå³ä¸‹ï¼Œä¸­å¿ƒï¼Œå…¨å±€resizeï¼Œå…­ä¸ªä½ç½®ã€‚<strong>ä¸€åˆ†ä¸ºå…­</strong></li>
<li>Step4: æ°´å¹³é•œåƒã€‚<strong>ä¸€åˆ†ä¸ºäºŒ</strong></li>
</ul>
</blockquote>
<p>$4\times 3\times 6\times 2 = 144$</p>
<p><strong>2.</strong> <strong>Model Fusion</strong></p>
<p>ä¸ƒä¸ªæ¨¡å‹è®­ç»ƒå·®å¼‚ä»…åœ¨å›¾åƒé‡‡æ ·æ–¹å¼å’Œé¡ºåºçš„å·®å¼‚</p>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220703150055607.png" alt="image-20220703150055607"></p>
<h2 id="7-æ¨¡å‹ç»“æœ"><a href="#7-æ¨¡å‹ç»“æœ" class="headerlink" title="7.æ¨¡å‹ç»“æœ"></a>7.æ¨¡å‹ç»“æœ</h2><p><strong>åˆ†ç±»ç»“æœï¼š</strong></p>
<ul>
<li>æ¨¡å‹èåˆï¼š å¤šæ¨¡å‹æ¯”å•æ¨¡å‹ç²¾åº¦é«˜ã€‚</li>
<li>Multi Crosï¼šcropè¶Šå¤šï¼Œç²¾åº¦è¶Šé«˜</li>
</ul>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220703151519045.png" alt="image-20220703151519045"></p>
<p><strong>æ£€æµ‹ç»“æœï¼š</strong></p>
<p>æ¨¡å‹èåˆï¼š å¤šæ¨¡å‹æ¯”å•æ¨¡å‹ç²¾åº¦é«˜</p>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220703151526007.png" alt="image-20220703151526007"></p>
<h2 id="8-ç¨€ç–ç»“æ„"><a href="#8-ç¨€ç–ç»“æ„" class="headerlink" title="8.ç¨€ç–ç»“æ„"></a>8.ç¨€ç–ç»“æ„</h2><p><strong>ç¨€ç–çŸ©é˜µï¼š</strong>æ•°å€¼ä¸º0çš„å…ƒç´ æ•°ç›®è¿œè¿œå¤šäºé0å…ƒç´ çš„æ•°ç›®ï¼Œ ä¸”æ— è§„å¾‹</p>
<p><strong>ç¨ å¯†çŸ©é˜µï¼š</strong>æ•°å€¼é0çš„å…ƒç´ æ•°ç›®è¿œè¿œå¤šäºä¸º0å…ƒç´ çš„æ•°ç›®ï¼Œ ä¸”æ— è§„å¾‹</p>
<p>ç¨€ç–çŸ©é˜µä¼˜ç‚¹æ˜¯ï¼Œå¯<strong>åˆ†è§£</strong>æˆå¯†é›†çŸ©é˜µè®¡ç®—æ¥åŠ å¿«æ”¶æ•›é€Ÿåº¦ã€‚ç¨€ç–çŸ©é˜µä¸­0è¾ƒå¤šçš„åŒºåŸŸå°±å¯ä»¥ä¸ç”¨è®¡ç®—ï¼Œè®¡ç®—é‡å°±å¤§å¤§é™ä½ã€‚</p>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220703152402337.png" alt="image-20220703152402337"></p>
<p><strong>ç‰¹å¾å›¾é€šé“çš„åˆ†è§£</strong></p>
<p>672ä¸ªç‰¹å¾å›¾åˆ†è§£ä¸ºå››ä¸ªéƒ¨åˆ†</p>
<ul>
<li>$1\times1$å·ç§¯æ ¸æå–çš„ 128ä¸ªé€šé“</li>
<li>$3\times 3$ å·ç§¯æ ¸æå–çš„192ä¸ªé€šé“</li>
<li>$5\times 5$å·ç§¯æ ¸æå–çš„96ä¸ªé€šé“</li>
<li>$3\times3$æ± åŒ–æå–çš„256ä¸ªé€šé“</li>
</ul>
<p>æ‰“ç ´<strong>å‡åŒ€åˆ†å¸ƒ</strong>ï¼Œç›¸å…³æ€§å¼ºçš„<strong>ç‰¹å¾èšé›†</strong>åœ¨ä¸€èµ·</p>
<blockquote>
<p>ã€æ€è€ƒã€‘Inceptionçš„è®¾è®¡æ€è·¯ï¼š</p>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220703114648018.png" alt="image-20220703114648018"></p>
<ul>
<li>åœ¨ç›´è§‚æ„Ÿè§‰ä¸Šåœ¨å¤šä¸ªå°ºåº¦ä¸ŠåŒæ—¶è¿›è¡Œå·ç§¯ï¼Œèƒ½æå–åˆ°ä¸åŒå°ºåº¦çš„ç‰¹å¾ã€‚ç‰¹å¾æ›´ä¸ºä¸°å¯Œä¹Ÿæ„å‘³ç€æœ€ååˆ†ç±»åˆ¤æ–­æ—¶æ›´åŠ å‡†ç¡®ã€‚</li>
<li>åˆ©ç”¨ç¨€ç–çŸ©é˜µåˆ†è§£æˆå¯†é›†çŸ©é˜µè®¡ç®—çš„åŸç†æ¥åŠ å¿«æ”¶æ•›é€Ÿåº¦ã€‚åœ¨inceptionä¸Šå°±æ˜¯è¦åœ¨ç‰¹å¾ç»´åº¦ä¸Šè¿›è¡Œåˆ†è§£ã€‚inceptionæ¨¡å—åœ¨å¤šä¸ªå°ºåº¦ä¸Šæå–ç‰¹å¾ï¼Œè¾“å‡ºçš„256ä¸ªç‰¹å¾å°±ä¸å†æ˜¯å‡åŒ€åˆ†å¸ƒï¼Œè€Œæ˜¯ç›¸å…³æ€§å¼ºçš„ç‰¹å¾èšé›†åœ¨ä¸€èµ·ï¼ˆæ¯”å¦‚$1\times1$çš„çš„96ä¸ªç‰¹å¾èšé›†åœ¨ä¸€èµ·ï¼Œ$3\times3$çš„96ä¸ªç‰¹å¾èšé›†åœ¨ä¸€èµ·ï¼Œ$5\times5$çš„64ä¸ªç‰¹å¾èšé›†åœ¨ä¸€èµ·ï¼‰ã€‚è¿™æ ·çš„ç‰¹å¾é›†ä¸­å› ä¸ºç›¸å…³æ€§è¾ƒå¼ºçš„ç‰¹å¾èšé›†åœ¨äº†ä¸€èµ·ï¼Œä¸ç›¸å…³çš„éå…³é”®ç‰¹å¾å°±è¢«å¼±åŒ–ï¼ŒåŒæ ·æ˜¯è¾“å‡º256ä¸ªç‰¹å¾ï¼Œinceptionæ–¹æ³•è¾“å‡ºçš„å†—ä½™ä¿¡æ¯è¾ƒå°‘ã€‚</li>
<li>Hebbinèµ«å¸ƒåŸç†ã€‚èµ«å¸ƒè®¤ä¸ºâ€œä¸¤ä¸ªç¥ç»å…ƒæˆ–è€…ç¥ç»å…ƒç³»ç»Ÿï¼Œå¦‚æœæ€»æ˜¯åŒæ—¶å…´å¥‹ï¼Œå°±ä¼šå½¢æˆä¸€ç§â€˜ç»„åˆâ€™ï¼Œå…¶ä¸­ä¸€ä¸ªç¥ç»å…ƒçš„å…´å¥‹ä¼šä¿ƒè¿›å¦ä¸€ä¸ªçš„å…´å¥‹â€ã€‚åœ¨inceptionç»“æ„ä¸­å°±æ˜¯è¦æŠŠç›¸å…³æ€§å¼ºçš„ç‰¹å¾æ±‡èšåˆ°ä¸€èµ·ï¼ŒæŠŠ$1\times1ï¼Œ3\times3ï¼Œ5\times5$çš„ç‰¹å¾åˆ†å¼€ã€‚å› ä¸ºè®­ç»ƒæ”¶æ•›çš„æœ€ç»ˆç›®çš„å°±æ˜¯è¦æå–å‡ºç‹¬ç«‹çš„ç‰¹å¾ï¼Œæ‰€ä»¥é¢„å…ˆæŠŠç›¸å…³æ€§å¼ºçš„ç‰¹å¾æ±‡èšï¼Œå°±èƒ½èµ·åˆ°åŠ é€Ÿæ”¶æ•›çš„ä½œç”¨ã€‚</li>
</ul>
</blockquote>
<h2 id="9-æ€»ç»“"><a href="#9-æ€»ç»“" class="headerlink" title="9.æ€»ç»“"></a>9.æ€»ç»“</h2><p><strong>å…³é”®ç‚¹&amp;åˆ›æ–°ç‚¹</strong></p>
<ul>
<li>å¤§é‡ä½¿ç”¨$1\times1$ï¼Œå¯é™ä½ç»´åº¦ï¼Œå‡å°‘è®¡ç®—é‡ï¼Œå‚æ•°æ˜¯AlexNetçš„æ˜¯åäºŒåˆ†ä¹‹ä¸€</li>
<li>å¤šå°ºåº¦å·ç§¯æ ¸ï¼Œå®ç°å¤šå°ºåº¦ç‰¹å¾æå–</li>
<li>è¾…åŠ©æŸå¤±å±‚ï¼Œå¢åŠ æ¢¯åº¦å›ä¼ ï¼Œå¢åŠ æ­£åˆ™ï¼Œå‡è½»è¿‡æ‹Ÿåˆ</li>
</ul>
<blockquote>
<p>æ€»ç»“ï¼š</p>
<ul>
<li>æ± åŒ–æŸå¤±ç©ºé—´åˆ†è¾¨ç‡ï¼Œä½†åœ¨å®šä½ã€æ£€æµ‹å’Œäººä½“å§¿æ€è¯†åˆ«ä¸­ä»åº”ç”¨ã€‚å»¶ä¼¸æ‹“å±•ï¼šå®šä½ã€æ£€æµ‹å’Œäººä½“å§¿æ€è¯†åˆ«è¿™äº›ä»»åŠ¡ååˆ†æ³¨é‡ç©ºé—´åˆ†è¾¨ç‡ä¿¡æ¯ã€‚</li>
<li>å¢åŠ æ¨¡å‹æ·±åº¦å’Œå®½åº¦ï¼Œå¯æœ‰æ•ˆæå‡æ€§èƒ½ï¼Œä½†æœ‰2ä¸ªç¼ºç‚¹ï¼šå®¹æ˜“è¿‡æ‹Ÿåˆï¼Œä»¥åŠè®¡ç®—é‡è¿‡å¤§</li>
<li>ä¸ºèŠ‚çœå†…å­˜æ¶ˆè€—ï¼Œå…ˆå°†åˆ†è¾¨ç‡é™ä½ï¼Œå†å †å ä½¿ç”¨Inception module</li>
<li>æœ€åä¸€ä¸ªå…¨è¿æ¥å±‚ï¼Œæ˜¯ä¸ºäº†æ›´æ–¹ä¾¿çš„å¾®è°ƒï¼Œè¿ç§»å­¦ä¹ </li>
<li>ç½‘ç»œä¸­é—´å±‚ç‰¹å¾å¯¹äºåˆ†ç±»ä¹Ÿå…·æœ‰åˆ¤åˆ«æ€§</li>
<li>å­¦ä¹ ç‡ä¸‹é™ç­–ç•¥ä¸ºæ¯8ä¸ªepochsä¸‹é™4%ï¼ˆlossæ›²çº¿å¾ˆå¹³æ»‘ï¼‰</li>
<li>æ•°æ®å¢å¼ºæŒ‡å¯¼æ–¹é’ˆï¼š1. å°ºå¯¸åœ¨8%-100%ï¼›2. é•¿å®½æ¯”åœ¨$[3/4,  4/3]$; 3. å…‰ç…§ç•¸å˜æœ‰æ•ˆ</li>
<li>éšæœºé‡‡ç”¨å·®å€¼æ–¹æ³•å¯æå‡æ€§èƒ½</li>
<li>å®é™…åº”ç”¨ä¸­æ²¡å¿…è¦144 crops</li>
</ul>
</blockquote>
<h2 id="10-æ”¹è¿›1-V2-æ‰¹æ ‡å‡†åŒ–"><a href="#10-æ”¹è¿›1-V2-æ‰¹æ ‡å‡†åŒ–" class="headerlink" title="10.æ”¹è¿›1 V2 æ‰¹æ ‡å‡†åŒ–"></a>10.æ”¹è¿›1 V2 æ‰¹æ ‡å‡†åŒ–</h2><p>åœ¨GoogLeNet-V1 åŸºç¡€ä¸ŠåŠ å…¥BNå±‚ï¼ŒåŒæ—¶å€Ÿé‰´VGGçš„å°å·ç§¯æ ¸æ€æƒ³ï¼Œå°†$5\times 5$å·ç§¯æ›¿æ¢ä¸º2ä¸ª$3\times3$å·ç§¯ï¼Œæå‡ºäº†GoogLeNet-V2ã€‚</p>
<p><strong>ç ”ç©¶æˆæœï¼š</strong></p>
<ol>
<li>æå‡ºBNå±‚ï¼šåŠ å¿«æ¨¡å‹æ”¶æ•›ï¼Œæ¯”googlenet-v1å¿«æ•°åå€ï¼Œè·å¾—æ›´ä¼˜ç»“æœ</li>
<li>GoogLeNet-v2 è·å¾—ILSVRC åˆ†ç±»ä»»åŠ¡ SOTAã€‚BNä½¿æ¨¡å‹è®­ç»ƒåŠ å¿«14å€ï¼Œå¹¶ä¸”å¯æ˜¾è‘—æé«˜åˆ†ç±»ç²¾åº¦ï¼Œåœ¨Imagenetåˆ†ç±»ä»»åŠ¡ä¸­è¶…è¶Šäº†äººç±»çš„è¡¨ç°ã€‚</li>
<li>å¼€å¯ç¥ç»ç½‘ç»œè®¾è®¡æ–°æ—¶ä»£ï¼Œæ ‡å‡†åŒ–å±‚å·²ç»æˆä¸ºæ·±åº¦ç¥ç»ç½‘ç»œæ ‡é…ã€‚åœ¨Batch NormalizationåŸºç¡€ä¸Šæ‹“å±•å‡ºäº†ä¸€ç³»ä¾‹æ ‡å‡†åŒ–ç½‘ç»œå±‚ï¼Œå¦‚Layer Normalizationï¼ˆLNï¼‰ï¼ŒInstance Normalizationï¼ˆINï¼‰ï¼ŒGroup Normalizationï¼ˆGNï¼‰</li>
</ol>
<blockquote>
<p><strong>ç›¸å…³ç ”ç©¶ï¼š</strong></p>
<ul>
<li>ICSï¼ˆInternal Covariate Shiftï¼Œå†…éƒ¨åå˜é‡åç§»ï¼‰ç°è±¡ï¼šè¾“å…¥æ•°æ®åˆ†å¸ƒå˜åŒ–ï¼Œå¯¼è‡´çš„æ¨¡å‹è®­ç»ƒå›°éš¾ï¼Œå¯¹æ·±åº¦ç¥ç»ç½‘ç»œå½±å“æå¤§ã€‚</li>
</ul>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/ç»˜å›¾1.png" alt="ç»˜å›¾1"></p>
<ul>
<li>ç™½åŒ–ï¼ˆWhiteningï¼‰ï¼šä¸ºäº†è§£å†³ICSï¼Œå¯ä»¥ä½¿ç”¨ç™½åŒ–çš„æ–¹æ³•ï¼Œå»é™¤è¾“å…¥æ•°æ®çš„å†—ä½™ä¿¡æ¯ï¼Œä½¿å¾—æ•°æ®ç‰¹å¾ä¹‹é—´çš„<strong>ç›¸å…³æ€§è¾ƒä½</strong>ï¼Œæ‰€æœ‰ç‰¹å¾å…·æœ‰<strong>ç›¸åŒæ–¹å·®</strong>ã€‚ä¾ç…§æ¦‚ç‡è®ºï¼Œ$N(x)=(x-\text{mean}/\text{std})$ï¼Œä½¿å¾—$x$å˜ä¸º0å‡å€¼ï¼Œ1æ ‡å‡†å·®ã€‚</li>
</ul>
</blockquote>
<p><strong>BN ä¼˜ç‚¹ï¼š</strong></p>
<ol>
<li>å¯ä»¥ç”¨æ›´å¤§å­¦ä¹ ç‡ï¼ŒåŠ é€Ÿæ¨¡å‹æ”¶æ•›ã€‚é’ˆå¯¹ç±»ä¼¼Sigmoidçš„é¥±å’Œæ¿€æ´»å‡½æ•°ï¼ŒåŠ ä¸ŠBNå±‚åï¼Œå¯é‡‡ç”¨è¾ƒå¤§å­¦ä¹ ç‡ã€‚</li>
<li>å¯ä»¥ä¸ç”¨ç²¾å¿ƒè®¾è®¡æƒå€¼åˆå§‹åŒ–</li>
<li>å¯ä»¥ä¸ç”¨dropoutæˆ–è¾ƒå°çš„dropoutã€‚. å……å½“<strong>æ­£åˆ™</strong>ï¼Œé¡¶æ›¿DropoutåŠ å…¥BNå±‚åï¼Œå°†å½“å‰æ ·æœ¬ä¸ä»¥å‰æ ·æœ¬é€šè¿‡ç»Ÿè®¡ä¿¡æ¯è”ç³»èµ·æ¥ï¼Œç›¸å½“äºæŸç§çº¦æŸï¼Œç»å®éªŒè¡¨æ˜å¯å‡è½»Dropoutçš„ä½¿ç”¨ã€‚</li>
<li>å¯ä»¥ä¸ç”¨L2æˆ–è€…è¾ƒå°çš„weight decay</li>
<li>å¯ä»¥ä¸ç”¨LRN(local response normalization)</li>
</ol>
<h3 id="10-1-BNå±‚"><a href="#10-1-BNå±‚" class="headerlink" title="10.1 BNå±‚"></a>10.1 BNå±‚</h3><blockquote>
<p>æ‰¹ï¼šä¸€æ‰¹æ•°æ®ï¼Œé€šå¸¸ä¸ºmini-batch </p>
<p>æ ‡å‡†åŒ–ï¼šä½¿å¾—åˆ†å¸ƒä¸º mean=0ï¼Œ std=1</p>
</blockquote>
<script type="math/tex; mode=display">
\widehat{x}^{(k)}=\frac{x^{(k)}-\mathrm{E}\left[x^{(k)}\right]}{\sqrt{\operatorname{Var}\left[x^{(k)}\right]}}</script><ul>
<li>å­˜åœ¨çš„é—®é¢˜ï¼šä½¿ç¥ç»å…ƒè¾“å‡ºå€¼åœ¨sigmodçš„çº¿æ€§åŒºï¼Œå‰Šå¼±äº†ç½‘ç»œçš„è¡¨è¾¾èƒ½åŠ›ã€‚</li>
<li>è§£å†³åŠæ³•ï¼š$y^{(k)}=\gamma^{(k)}\widehat{x}^{(k)}+\beta^{(k)}$ã€‚é‡‡ç”¨<strong>å¯å­¦ä¹ å‚æ•°</strong>$\gamma$å’Œ$\beta$ï¼Œå¢åŠ çº¿æ€§å˜æ¢ï¼Œæå‡ç½‘ç»œè¡¨è¾¾èƒ½åŠ›ï¼ŒåŒæ—¶æä¾›<strong>æ’ç­‰æ˜ å°„</strong>çš„å¯èƒ½ï¼ˆå½“$\gamma^{(k)}=\sqrt{\operatorname{Var}[x^{(k)}]}$å’Œ$\beta^{(k)}=\mathrm{E}[x^{(k)}]$æ—¶ï¼ŒBNå±‚å˜ä¸ºæ’ç­‰æ˜ å°„ï¼Œä¸æ”¹å˜ç¥ç»å…ƒçš„è¾“å‡ºå€¼ã€‚$\widehat{x}^{(k)}=\frac{x^{(k)}-\mathrm{E}\left[x^{(k)}\right]}{\sqrt{\operatorname{Var}\left[x^{(k)}\right]}}$ï¼‰</li>
</ul>
<p><strong>å…·ä½“æ“ä½œï¼š</strong></p>
<ul>
<li>åœ¨mini-batchä¸Šè®¡ç®—å‡å€¼</li>
<li>åœ¨mini-batchä¸Šè®¡ç®—æ ‡å‡†å·®</li>
<li>å‡å»å‡å€¼ï¼Œé™¤ä»¥æ ‡å‡†å·®ï¼Œ$\epsilon =1\times10^{-5}$ï¼Œé¿å…åˆ†æ¯ä¸º0</li>
<li>çº¿æ€§å˜æ¢ï¼Œ$\gamma$å’Œ$\beta$å®ç°ç¼©æ”¾ä¸å¹³ç§»ã€‚</li>
</ul>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220703184346992.png" alt="image-20220703184346992"></p>
<p>æ­¤æ—¶å­˜åœ¨çš„é—®é¢˜ï¼šmini-batchçš„ç»Ÿè®¡ä¿¡æ¯å……å½“æ€»ä½“æ˜¯ä¸å‡†ç¡®çš„</p>
<p>è§£å†³åŠæ³•ï¼šé‡‡ç”¨<strong>æŒ‡æ•°æ»‘åŠ¨å¹³å‡ï¼ˆExponential Moving Averageï¼‰</strong>æ¥ä¼°è®¡æ•´ä½“çš„å‡å€¼ï¼Œå…·ä½“æ“ä½œå¦‚ä¸‹ï¼Œå…¬å¼ä¸­ï¼Œ$a_t$ä¸ºå½“å‰å€¼ï¼Œ$\text{mv}_t$ä¸ºæŒ‡æ•°æ»‘åŠ¨å¹³å‡å€¼ï¼Œ$\text{decay}$æ§åˆ¶æƒé‡è¡°å‡çš„é€Ÿåº¦ã€‚</p>
<script type="math/tex; mode=display">
\begin{align}

\text{mv}_t & = \text{decay}\times\text{mv}_{t-1}+(1-\text{decay})\times a_t\\
\text{mv}_t & = \sum_{i  = 1}^t \text{decay}^{t-i}\times (1-\text{decay})\times a_t

\end{align}</script><p>å±•å¼€è¡¨ç¤ºä¸ºï¼š</p>
<ul>
<li><p>$\text{mv}_1=(1-\text{decay})a_1$</p>
</li>
<li><p>$\text{mv}_2=\text{decay}\times\text{mv}_1+ (1-\text{decay})a_2=\text{decay}(1-\text{decay})a_1+ (1-\text{decay})a_2$</p>
</li>
<li><p>$\text{mv}_3=\text{decay}^2(1-\text{decay})a_1+ \text{decay}(1-\text{decay})a_2+(1-\text{decay})a_3$</p>
</li>
<li><p>å½“$t-i&gt;C$ï¼Œ$C$ä¸ºæ— ç©·å¤§çš„æ—¶å€™ï¼Œæœ‰ï¼š</p>
<script type="math/tex; mode=display">
\begin{align}
& \text{decay}^{t-i} \times(1-\text{decay})\times a_t\approx 0\\
& \text{mv}_t  \approx\sum_{i  = t-C}^{t}\text{decay}^{t-i}\times(1-\text{decay})\times a_t
\end{align}</script></li>
</ul>
<p>æ‰€ä»¥ï¼Œç®—æ³•çš„æ ¸å¿ƒéƒ¨åˆ†å¯ä»¥è¡¨ç¤ºä¸ºï¼š</p>
<script type="math/tex; mode=display">
\begin{aligned}
\widehat{x}_{i} & \leftarrow \frac{x_{i}-\mu_{\mathcal{B}}}{\sqrt{\sigma_{\mathcal{B}}^{2}+\epsilon}} \\
y_{i} & \leftarrow \widehat{x}_{i}+\beta \equiv \mathrm{BN}_{\gamma, \beta}\left(x_{i}\right)
\end{aligned}</script><p>ç®—æ³•çš„æ•´ä½“æµç¨‹å¦‚ä¸‹ï¼š</p>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220703185154418.png" alt="image-20220703185154418"></p>
<h3 id="10-2-GoogleNetV2ç½‘ç»œç»“æ„"><a href="#10-2-GoogleNetV2ç½‘ç»œç»“æ„" class="headerlink" title="10.2 GoogleNetV2ç½‘ç»œç»“æ„"></a>10.2 GoogleNetV2ç½‘ç»œç»“æ„</h3><p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220703191126773.png" alt="image-20220703191126773"></p>
<blockquote>
<p>å¯¹V1çš„æ”¹è¿›ï¼š </p>
<ol>
<li>æ¿€æ´»å‡½æ•°å‰åŠ å…¥BN</li>
<li>$5\times5$å·ç§¯æ›¿æ¢ä¸º2ä¸ª$3\times3$å·ç§¯ï¼ˆå°å·ç§¯æ ¸ç»“æ„ï¼‰</li>
<li>ç¬¬ä¸€ä¸ªInceptionæ¨¡å—å¢åŠ ä¸€ä¸ªInceptionç»“æ„</li>
<li>å¢å¤š$5\times5$å·ç§¯æ ¸</li>
<li>å°ºå¯¸å˜åŒ–é‡‡ç”¨stride=2çš„å·ç§¯ï¼ˆä¸å†ä½¿ç”¨æ± åŒ–æ“ä½œï¼‰</li>
<li>å¢åŠ 9å±‚ï¼ˆ10-1å±‚ï¼‰åˆ° 31å±‚ï¼ˆ10è¡¨ç¤ºinceptionæ•°é‡ï¼‰ï¼Œä½¿ç”¨äº†æ›´å¤šçš„å·ç§¯æ ¸</li>
</ol>
</blockquote>
<p>åŠ å…¥BNçš„å·ç§¯å±‚ï¼š</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">BasicConv2d</span>(nn.Module):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, in_channels, out_channels, **kwargs</span>):</span><br><span class="line">        <span class="built_in">super</span>(BasicConv2d, self).__init__()</span><br><span class="line">        self.conv = nn.Conv2d(in_channels, out_channels, bias=<span class="literal">False</span>, **kwargs)</span><br><span class="line">        self.bn = nn.BatchNorm2d(out_channels, eps=<span class="number">0.001</span>)  <span class="comment"># googlenet-v2</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        x = self.conv(x)</span><br><span class="line">        x = self.bn(x)  <span class="comment"># googlenet-v2</span></span><br><span class="line">        <span class="keyword">return</span> F.relu(x, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></tbody></table></figure>
<h3 id="10-3-å®éªŒ"><a href="#10-3-å®éªŒ" class="headerlink" title="10.3 å®éªŒ"></a>10.3 å®éªŒ</h3><p>å…¶ä½¿ç”¨çš„æ˜¯tanhæ¿€æ´»å‡½æ•°ï¼Œä»ä¸‹å›¾ä¸­å¯ä»¥å‘ç°ï¼š</p>
<ul>
<li>çº¢è‰²ä¸ºæœªåŠ å…¥BNå±‚çš„ï¼Œåœ¨å‡ ä¸ªepochåï¼Œå…¶åˆ†å¸ƒä¸»è¦é›†ä¸­åœ¨ä¸¤ä¾§ï¼Œè¯´æ˜å·²ç»è½å…¥äº†æ¿€æ´»å‡½æ•°çš„é¥±å’ŒåŒºé—´ï¼ˆåœ¨åé¢çš„å‡ ä¸ªepochä¸­ï¼Œå¦‚&gt;6ä¸ªepochåï¼Œæ¢¯åº¦å¾ˆå°ï¼Œæ¢¯åº¦ä¸ä¼šæ›´æ–°äº†ï¼‰ï¼Œè€ŒåŠ å…¥BNå±‚åï¼Œå¯ä»¥æ‹‰è‡³0å‡å€¼é™„è¿‘ï¼Œé¿å…è¿›å…¥é¥±å’ŒåŒºï¼Œå…¶åˆ†å¸ƒä¼šç›¸å¯¹å‡åŒ€ã€‚</li>
</ul>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/bn_tanh.gif" alt="bn_tanh"></p>
<h3 id="10-4-nn-batchnorm"><a href="#10-4-nn-batchnorm" class="headerlink" title="10.4 nn.batchnorm"></a>10.4 nn.batchnorm</h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">torch.nn.BatchNorm1d(num_features, </span><br><span class="line">                     eps=<span class="number">1e-05</span>, </span><br><span class="line">                     momentum=<span class="number">0.1</span>, </span><br><span class="line">                     affine=<span class="literal">True</span>, </span><br><span class="line">                     track_running_stats=<span class="literal">True</span>)</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>num_features â€“ ä¸€ä¸ªæ ·æœ¬çš„ç‰¹å¾æ•°é‡ï¼ˆæœ€é‡è¦ï¼ï¼ï¼‰</li>
<li>eps â€“ ä¸ºæ•°å€¼ç¨³å®šæ€§è€ŒåŠ åˆ°åˆ†æ¯ä¸Šçš„å€¼$\epsilon$ã€‚</li>
<li>momentum â€“ ç§»åŠ¨å¹³å‡çš„åŠ¨é‡å€¼ã€‚</li>
<li>affine â€“ ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå½“è®¾ç½®ä¸ºçœŸæ—¶ï¼Œæ­¤æ¨¡å—å…·æœ‰å¯å­¦ä¹ çš„ä»¿å°„å‚æ•°ã€‚</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">torch.nn.BatchNorm2d(num_features, eps=<span class="number">1e-05</span>, momentum=<span class="number">0.1</span>, </span><br><span class="line">                     affine=<span class="literal">True</span>, </span><br><span class="line">                     track_running_stats=<span class="literal">True</span>, </span><br><span class="line">                     device=<span class="literal">None</span>, dtype=<span class="literal">None</span>)</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">torch.nn.BatchNorm3d(num_features, eps=<span class="number">1e-05</span>, momentum=<span class="number">0.1</span>, </span><br><span class="line">                     affine=<span class="literal">True</span>, </span><br><span class="line">                     track_running_stats=<span class="literal">True</span>, </span><br><span class="line">                     device=<span class="literal">None</span>, dtype=<span class="literal">None</span>)</span><br></pre></td></tr></tbody></table></figure>
<p>è¯´æ˜ï¼šæ­¤å¤„çš„æ›´æ–°æ–¹å¼ä¸è®ºæ–‡ä¸­ç•¥æœ‰ä¸åŒï¼š</p>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220703214657092.png" alt="image-20220703214657092"></p>
<h2 id="11-æ”¹è¿›2-V3-æ”¹è¿›Inception"><a href="#11-æ”¹è¿›2-V3-æ”¹è¿›Inception" class="headerlink" title="11.æ”¹è¿›2 V3 æ”¹è¿›Inception"></a>11.æ”¹è¿›2 V3 æ”¹è¿›Inception</h2><p>ç ”ç©¶æˆæœï¼š</p>
<p>1.æå‡ºInception-V2 å’Œ Inception-V3ï¼Œ Inception-V3æ¨¡å‹è·å¾— ILSVRC åˆ†ç±»ä»»åŠ¡<strong>SOTA</strong></p>
<p>2.æå‡º4ä¸ªç½‘ç»œ<strong>æ¨¡å‹è®¾è®¡å‡†åˆ™</strong>ï¼Œä¸ºæ¨¡å‹è®¾è®¡æä¾›å‚è€ƒ</p>
<p>3.æå‡º<strong>å·ç§¯åˆ†è§£ã€é«˜æ•ˆé™ä½ç‰¹å¾å›¾åˆ†è¾¨ç‡</strong>æ–¹æ³•å’Œæ ‡ç­¾å¹³æ»‘æŠ€å·§ï¼Œæå‡ç½‘ç»œé€Ÿåº¦ä¸ç²¾åº¦</p>
<div class="table-container">
<table>
<thead>
<tr>
<th style="text-align:center"><strong>æ¨¡å‹</strong></th>
<th style="text-align:center"><strong>æ—¶é—´</strong></th>
<th style="text-align:center"><strong>top-5</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">AlexNet</td>
<td style="text-align:center">2012</td>
<td style="text-align:center">15.3%</td>
</tr>
<tr>
<td style="text-align:center">ZFNet</td>
<td style="text-align:center">2013</td>
<td style="text-align:center">13.5%</td>
</tr>
<tr>
<td style="text-align:center">VGG</td>
<td style="text-align:center">2014</td>
<td style="text-align:center">7.3%</td>
</tr>
<tr>
<td style="text-align:center">GoogLeNet</td>
<td style="text-align:center">2014</td>
<td style="text-align:center">6.6%</td>
</tr>
<tr>
<td style="text-align:center">GoogLeNet v2</td>
<td style="text-align:center">2015</td>
<td style="text-align:center">4.9%</td>
</tr>
<tr>
<td style="text-align:center">GoogLeNet v3</td>
<td style="text-align:center">2015</td>
<td style="text-align:center">3.5%</td>
</tr>
</tbody>
</table>
</div>
<blockquote>
<p>æ€»ç»“ï¼šç½‘ç»œè®¾è®¡å‡†åˆ™ï¼š</p>
<p>1.å°½é‡é¿å…<strong>ä¿¡æ¯ç“¶é¢ˆ</strong>ï¼Œé€šå¸¸å‘ç”Ÿåœ¨<strong>æ± åŒ–å±‚</strong>ï¼Œå³ç‰¹å¾å›¾å˜å°ï¼Œä¿¡æ¯é‡å‡å°‘ï¼Œç±»ä¼¼ä¸€ä¸ªç“¶é¢ˆã€‚</p>
<p>2.é‡‡ç”¨æ›´<strong>é«˜ç»´</strong>çš„è¡¨ç¤ºæ–¹æ³•èƒ½å¤Ÿæ›´å®¹æ˜“çš„å¤„ç†ç½‘ç»œçš„å±€éƒ¨ä¿¡æ¯ã€‚</p>
<p>3.å¤§çš„å·ç§¯æ ¸å¯ä»¥åˆ†è§£ä¸ºæ•°ä¸ªå°å·ç§¯æ ¸ï¼Œä¸”ä¸ä¼šé™ä½ç½‘ç»œèƒ½åŠ›ã€‚</p>
<p>4.æŠŠæ¡å¥½æ·±åº¦å’Œå®½åº¦çš„å¹³è¡¡ã€‚</p>
</blockquote>
<h3 id="11-1-å·ç§¯åˆ†è§£"><a href="#11-1-å·ç§¯åˆ†è§£" class="headerlink" title="11.1 å·ç§¯åˆ†è§£"></a>11.1 å·ç§¯åˆ†è§£</h3><ul>
<li><p><strong>ç¬¬ä¸€ç§åˆ†è§£</strong>ï¼šå¤§å·ç§¯æ ¸åˆ†è§£ä¸ºå°å·ç§¯æ ¸å †å ï¼Œ1ä¸ª$5\times5$å·ç§¯åˆ†è§£ä¸º2ä¸ª$3\times3$å·ç§¯ï¼Œå‚æ•°å‡å°‘$1 -(9+9)/25 = 0.28%$ï¼ˆåœ¨VGGä¸­æœ‰è¯¦ç»†çš„ä»‹ç»ï¼‰</p>
</li>
<li><p><strong>ç¬¬äºŒç§åˆ†è§£</strong>ï¼šåˆ†è§£ä¸º<strong>éå¯¹ç§°å·ç§¯ï¼ˆAsymmetric Convolutionalsï¼‰</strong>1ä¸ª$n\times n$å·ç§¯åˆ†è§£ä¸º$1\times n$å·ç§¯ å’Œ$n\times 1$å·ç§¯å †å ã€‚å¯¹äº$3\times 3$è€Œè¨€ï¼Œå‚æ•°å‡å°‘ $1 - (3+3)/9 = 0.33$ã€‚æ³¨æ„äº‹é¡¹ï¼šéå¯¹ç§°å·ç§¯åœ¨ååŠæ®µä½¿ç”¨æ•ˆæœæ‰å¥½ï¼Œç‰¹åˆ«æ˜¯ç‰¹å¾å›¾åˆ†è¾¨ç‡åœ¨$12\sim20$ä¹‹é—´ï¼Œæœ¬æ–‡åœ¨åˆ†è¾¨ç‡ä¸º$17\times17$çš„æ—¶å€™ä½¿ç”¨éå¯¹ç§°å·ç§¯åˆ†è§£ã€‚</p>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/ç»˜å›¾1-1656857524427.png" alt="ç»˜å›¾1"></p>
</li>
</ul>
<h3 id="11-2-è¾…åŠ©åˆ†ç±»å±‚çš„æ”¹è¿›"><a href="#11-2-è¾…åŠ©åˆ†ç±»å±‚çš„æ”¹è¿›" class="headerlink" title="11.2 è¾…åŠ©åˆ†ç±»å±‚çš„æ”¹è¿›"></a>11.2 è¾…åŠ©åˆ†ç±»å±‚çš„æ”¹è¿›</h3><p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220703121824604.png" alt="image-20220703121824604"></p>
<p>GoogleNetV1ä¸­æå‡ºè¾…åŠ©åˆ†ç±»å±‚ï¼Œç”¨äºç¼“è§£æ¢¯åº¦æ¶ˆå¤±ï¼Œæå‡åº•å±‚çš„ç‰¹å¾æå–èƒ½åŠ›ï¼Œæœ¬æ–‡å¯¹è¾…åŠ©åˆ†ç±»å±‚è¿›è¡Œåˆ†æï¼Œå¾—å‡ºç»“è®ºï¼š</p>
<ul>
<li>è¾…åŠ©åˆ†ç±»å±‚åœ¨åˆæœŸèµ·ä¸åˆ°ä½œç”¨ï¼Œ<strong>åœ¨åæœŸæ‰èƒ½æå‡ç½‘ç»œæ€§èƒ½</strong>ï¼Œå› æ­¤ç§»é™¤ç¬¬ä¸€ä¸ªè¾…åŠ©åˆ†ç±»å±‚ä¸å½±å“ç²¾åº¦ã€‚</li>
<li>è¾…åŠ©åˆ†ç±»å±‚å¯è¾…åŠ©ä½å±‚æå–ç‰¹å¾æ˜¯ä¸æ­£ç¡®çš„</li>
<li>è¾…åŠ©åˆ†ç±»å±‚å¯¹æ¨¡å‹èµ·åˆ°æ­£åˆ™çš„ä½œç”¨</li>
<li>googlenet-v3åªåœ¨$17\times17$ç‰¹å¾å›¾ç»“æŸæ¥å…¥è¾…åŠ©åˆ†ç±»å±‚</li>
</ul>
<h3 id="11-3-é«˜æ•ˆç‰¹å¾å›¾ä¸‹é™ç­–ç•¥"><a href="#11-3-é«˜æ•ˆç‰¹å¾å›¾ä¸‹é™ç­–ç•¥" class="headerlink" title="11.3 é«˜æ•ˆç‰¹å¾å›¾ä¸‹é™ç­–ç•¥"></a>11.3 é«˜æ•ˆç‰¹å¾å›¾ä¸‹é™ç­–ç•¥</h3><ul>
<li>ç‰¹å¾å›¾ä¸‹é™æ–¹å¼æ¢è®¨ï¼šä¼ ç»Ÿæ± åŒ–æ–¹æ³•å­˜åœ¨ä¿¡æ¯è¡¨å¾ç“¶é¢ˆï¼ˆrepresentational bottlenecksï¼‰é—®é¢˜ï¼ˆè¿åæ¨¡å‹è®¾è®¡å‡†åˆ™1ï¼‰ï¼Œå³<strong>ç‰¹å¾å›¾ä¿¡æ¯å˜å°‘äº†</strong>ã€‚<ul>
<li>ç®€å•è§£å†³æ–¹æ³•ï¼šå…ˆç”¨å·ç§¯å°†ç‰¹å¾å›¾é€šé“æ•°ç¿»å€ï¼Œå†ç”¨æ± åŒ–ã€‚</li>
<li>å­˜åœ¨é—®é¢˜ï¼šè®¡ç®—é‡è¿‡å¤§</li>
<li>è§£å†³æ–¹æ³•ï¼šç”¨å·ç§¯å¾—åˆ°ä¸€åŠçš„ç‰¹å¾å›¾ï¼Œç”¨æ± åŒ–å¾—åˆ°å¦ä¸€åŠçš„ç‰¹å¾å›¾ã€‚</li>
</ul>
</li>
</ul>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220704010816003.png" alt="image-20220704010816003"></p>
<ul>
<li><strong>é«˜æ•ˆç‰¹å¾å›¾åˆ†è¾¨ç‡ä¸‹é™ç­–ç•¥ï¼š</strong>ç”¨å·ç§¯å¾—åˆ°ä¸€åŠç‰¹å¾å›¾ï¼Œç”¨æ± åŒ–å¾—åˆ°ä¸€åŠç‰¹å¾å›¾ã€‚ç”¨è¾ƒå°‘çš„è®¡ç®—é‡è·å¾—è¾ƒå¤šçš„ä¿¡æ¯ï¼Œé¿å…ä¿¡æ¯è¡¨å¾ç“¶é¢ˆï¼ˆ representational bottlenecksï¼‰<ul>
<li>è¯¥Inception-moduleç”¨äº$35\times 35$ä¸‹é™è‡³$17\times 17$ï¼Œä»¥åŠ$17\times17$ä¸‹é™è‡³$8\times8$ã€‚ä¸‹å›¾ä¸­å³ä¾§ä¸ºå·¦ä¾§çš„ç®€åŒ–ï¼š</li>
</ul>
</li>
</ul>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220704010909470.png" alt="image-20220704010909470"></p>
<h3 id="11-4-æ ‡ç­¾å¹³æ»‘"><a href="#11-4-æ ‡ç­¾å¹³æ»‘" class="headerlink" title="11.4 æ ‡ç­¾å¹³æ»‘"></a>11.4 æ ‡ç­¾å¹³æ»‘</h3><p>ä¼ ç»Ÿçš„ont-hotç¼–ç ä¸­å­˜åœ¨çš„é—®é¢˜ï¼šå¯¼è‡´è¿‡æ‹Ÿåˆ</p>
<p>æå‡ºäº†æ ‡ç­¾å¹³æ»‘ï¼ŒæŠŠone-hotä¸­æ¦‚ç‡ä¸º1çš„é‚£ä¸€é¡¹è¿›è¡Œè¡°å‡ï¼Œè¡°å‡çš„é‚£éƒ¨åˆ†è‡ªä¿¡åº¦å¹³å‡åˆ†åˆ°æ¯ä¸€ä¸ªç±»åˆ«ä¸­ã€‚</p>
<p>ä¸¾ä¾‹ï¼š4åˆ†ç±»ä»»åŠ¡ï¼Œ$\text{label}=(0,1,0,0)$</p>
<p>æ ‡ç­¾å¹³æ»‘åï¼š</p>
<script type="math/tex; mode=display">
\begin{align}
\text{label Smoothing} & = (0.001/4,1-0.001+0.001/4,0.001/4,0.001/4)\\ & = (0.00025,0.99925,0.00025,0.00025)
\end{align}</script><p><strong>æ ‡ç­¾å¹³æ»‘å…¬å¼ï¼š</strong></p>
<p>äº¤å‰ç†µï¼ˆCross Entropyï¼‰ï¼š$H(q,p)=-\sum_{k=1}^k\log(p_k)q_k$ï¼Œå…¶ä¸­$q$ä¸ºone-hotå‘é‡ã€‚</p>
<p>æ ‡ç­¾å¹³æ»‘ï¼šå°†$q$æ ‡ç­¾å¹³æ»‘ä¸º$qâ€™$ï¼Œè®©æ¨¡å‹è¾“å‡ºçš„$p$åˆ†å¸ƒå»é€¼è¿‘$qâ€™$</p>
<ul>
<li>$qâ€™(k|x)=(1-\varepsilon )\delta_{k,y}+\varepsilon u(k)$ï¼Œå…¶ä¸­$u(k)$ä¸ºä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œè¿™é‡Œå¦‚æœé‡‡ç”¨å‡åŒ€åˆ†å¸ƒï¼Œåˆ™å¯ä»¥å¾—åˆ°ï¼š$qâ€™(k|x)=(1-\varepsilon )\delta_{k,y}+\frac{\varepsilon }{k}$</li>
<li>æ‰€ä»¥æ ‡ç­¾å¹³æ»‘åçš„äº¤å‰ç†µæŸå¤±å‡½æ•°ä¸ºï¼š</li>
</ul>
<p>æ¨å¯¼ï¼š</p>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220704013211670.png" alt="image-20220704013211670"></p>
<p>å³ï¼š</p>
<script type="math/tex; mode=display">
H(q',p)=-\sum_{k=1}^k\log(p_k)q'_k=(1-\varepsilon )H(q,p)+\varepsilon H(q',p)</script><h3 id="11-5-æ¨¡å‹ç»“æ„"><a href="#11-5-æ¨¡å‹ç»“æ„" class="headerlink" title="11.5 æ¨¡å‹ç»“æ„"></a>11.5 æ¨¡å‹ç»“æ„</h3><p>é’ˆå¯¹V1çš„å˜åŒ–ï¼š</p>
<ul>
<li>é‡‡ç”¨3ä¸ª$3\times3$å·ç§¯æ›¿æ¢1ä¸ª$7\times 7$å·ç§¯ï¼Œå¹¶ä¸”åœ¨ç¬¬ä¸€ä¸ªå·ç§¯å°±é‡‡ç”¨stride=2æ¥é™ä½åˆ†è¾¨ç‡</li>
<li>ç¬¬äºŒä¸ª$3\times3$å·ç§¯ï¼Œåœ¨ç¬¬2ä¸ªå·ç§¯æ‰ä¸‹é™åˆ†è¾¨ç‡</li>
<li>ç¬¬ä¸€ä¸ªblockå¢åŠ ä¸€ä¸ªinception-moduleï¼Œç¬¬ä¸€ä¸ªinception-moduleåªæ˜¯å°†$5\times5$å·ç§¯æ›¿æ¢ä¸º2ä¸ª$3\times3$å·ç§¯ã€‚</li>
<li>ç¬¬äºŒä¸ªblockï¼Œå¤„ç†$17\times17$ç‰¹å¾å›¾ï¼Œé‡‡ç”¨éå¯¹ç§°å·ç§¯ã€‚</li>
<li>ç¬¬ä¸‰ä¸ªblockï¼Œå¤„ç†$8\times8$ç‰¹å¾å›¾ï¼Œéµå¾ªå‡†åˆ™2ï¼Œæå‡ºæ‹“å±•çš„å·ç§¯</li>
<li>æœ€åè¾“å‡º2048ä¸ªç¥ç»å…ƒï¼ˆV1æ˜¯1024ä¸ªç¥ç»å…ƒï¼‰</li>
</ul>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220704192619266.png" alt="image-20220704192619266"></p>
<p>æ‹“å±•çš„å·ç§¯ç»“æ„å¦‚ä¸‹ï¼ˆInceptionV2ç»“æ„ï¼‰ï¼š</p>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/image-20220704194000260.png" alt="image-20220704194000260" style="zoom:80%;"></p>
<p>Inception V3å¯¹V2çš„æ”¹è¿›ï¼š</p>
<ul>
<li>é‡‡ç”¨RMSPropä¼˜åŒ–æ–¹æ³•</li>
<li>é‡‡ç”¨Label Smoothingæ­£åˆ™åŒ–æ–¹æ³•</li>
<li>é‡‡ç”¨éå¯¹ç§°å·ç§¯æå–$17\times17$ç‰¹å¾å›¾</li>
<li>é‡‡ç”¨å¸¦BNçš„è¾…åŠ©åˆ†ç±»å±‚</li>
</ul>
<h3 id="11-6-å„ä¸ªInceptionç»“æ„çš„ä»£ç "><a href="#11-6-å„ä¸ªInceptionç»“æ„çš„ä»£ç " class="headerlink" title="11.6 å„ä¸ªInceptionç»“æ„çš„ä»£ç "></a>11.6 å„ä¸ªInceptionç»“æ„çš„ä»£ç </h3><p>æ ¸å¿ƒéƒ¨åˆ†ä»£ç ï¼šåªä¿ç•™äº†<code>init</code>å’Œ<code>forward</code>ä¸¤ä¸ªå‡½æ•°</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Inception3</span>(nn.Module):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, num_classes=<span class="number">1000</span>, aux_logits=<span class="literal">True</span>, transform_input=<span class="literal">False</span>, init_weights=<span class="literal">False</span>,</span></span><br><span class="line"><span class="params">                 inception_blocks=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(Inception3, self).__init__()</span><br><span class="line">        <span class="keyword">if</span> inception_blocks <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            <span class="comment"># inceptionæ ¸å¿ƒç»„ä»¶ï¼ï¼ï¼</span></span><br><span class="line">            inception_blocks = [</span><br><span class="line">                BasicConv2d, InceptionA, InceptionB, InceptionC,</span><br><span class="line">                InceptionD, InceptionE, InceptionAux</span><br><span class="line">            ]</span><br><span class="line">        <span class="keyword">assert</span> <span class="built_in">len</span>(inception_blocks) == <span class="number">7</span></span><br><span class="line">        conv_block = inception_blocks[<span class="number">0</span>]</span><br><span class="line">        inception_a = inception_blocks[<span class="number">1</span>]</span><br><span class="line">        inception_b = inception_blocks[<span class="number">2</span>]</span><br><span class="line">        inception_c = inception_blocks[<span class="number">3</span>]</span><br><span class="line">        inception_d = inception_blocks[<span class="number">4</span>]</span><br><span class="line">        inception_e = inception_blocks[<span class="number">5</span>]</span><br><span class="line">        inception_aux = inception_blocks[<span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">        self.aux_logits = aux_logits</span><br><span class="line">        self.transform_input = transform_input</span><br><span class="line">        </span><br><span class="line">        self.Conv2d_1a_3x3 = conv_block(<span class="number">3</span>, <span class="number">32</span>, kernel_size=<span class="number">3</span>, stride=<span class="number">2</span>)</span><br><span class="line">        self.Conv2d_2a_3x3 = conv_block(<span class="number">32</span>, <span class="number">32</span>, kernel_size=<span class="number">3</span>)</span><br><span class="line">        self.Conv2d_2b_3x3 = conv_block(<span class="number">32</span>, <span class="number">64</span>, kernel_size=<span class="number">3</span>, padding=<span class="number">1</span>)</span><br><span class="line">        self.Conv2d_3b_1x1 = conv_block(<span class="number">64</span>, <span class="number">80</span>, kernel_size=<span class="number">1</span>)</span><br><span class="line">        self.Conv2d_4a_3x3 = conv_block(<span class="number">80</span>, <span class="number">192</span>, kernel_size=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">        self.Mixed_5b = inception_a(<span class="number">192</span>, pool_features=<span class="number">32</span>)</span><br><span class="line">        self.Mixed_5c = inception_a(<span class="number">256</span>, pool_features=<span class="number">64</span>)</span><br><span class="line">        self.Mixed_5d = inception_a(<span class="number">288</span>, pool_features=<span class="number">64</span>)</span><br><span class="line"></span><br><span class="line">        self.Mixed_6a = inception_b(<span class="number">288</span>)</span><br><span class="line">        self.Mixed_6b = inception_c(<span class="number">768</span>, channels_7x7=<span class="number">128</span>)</span><br><span class="line">        self.Mixed_6c = inception_c(<span class="number">768</span>, channels_7x7=<span class="number">160</span>)</span><br><span class="line">        self.Mixed_6d = inception_c(<span class="number">768</span>, channels_7x7=<span class="number">160</span>)</span><br><span class="line">        self.Mixed_6e = inception_c(<span class="number">768</span>, channels_7x7=<span class="number">192</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> aux_logits:</span><br><span class="line">            self.AuxLogits = inception_aux(<span class="number">768</span>, num_classes)</span><br><span class="line"></span><br><span class="line">        self.Mixed_7a = inception_d(<span class="number">768</span>)</span><br><span class="line">        self.Mixed_7b = inception_e(<span class="number">1280</span>)</span><br><span class="line">        self.Mixed_7c = inception_e(<span class="number">2048</span>)</span><br><span class="line">        </span><br><span class="line">        self.fc = nn.Linear(<span class="number">2048</span>, num_classes)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> init_weights:</span><br><span class="line">            self._initialize_weights()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_forward</span>(<span class="params">self, x</span>):</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 1/5</span></span><br><span class="line">        <span class="comment"># N x 3 x 299 x 299</span></span><br><span class="line">        x = self.Conv2d_1a_3x3(x)</span><br><span class="line">        <span class="comment"># N x 32 x 149 x 149</span></span><br><span class="line">        x = self.Conv2d_2a_3x3(x)</span><br><span class="line">        <span class="comment"># N x 32 x 147 x 147</span></span><br><span class="line">        x = self.Conv2d_2b_3x3(x)</span><br><span class="line">        <span class="comment"># N x 64 x 147 x 147</span></span><br><span class="line">        x = F.max_pool2d(x, kernel_size=<span class="number">3</span>, stride=<span class="number">2</span>)</span><br><span class="line">        <span class="comment"># N x 64 x 73 x 73</span></span><br><span class="line">        x = self.Conv2d_3b_1x1(x)</span><br><span class="line">        <span class="comment"># N x 80 x 73 x 73</span></span><br><span class="line">        x = self.Conv2d_4a_3x3(x)</span><br><span class="line">        <span class="comment"># N x 192 x 71 x 71</span></span><br><span class="line">        x = F.max_pool2d(x, kernel_size=<span class="number">3</span>, stride=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 2/5</span></span><br><span class="line">        <span class="comment"># N x 192 x 35 x 35</span></span><br><span class="line">        x = self.Mixed_5b(x)</span><br><span class="line">        <span class="comment"># N x 256 x 35 x 35</span></span><br><span class="line">        x = self.Mixed_5c(x)</span><br><span class="line">        <span class="comment"># N x 288 x 35 x 35</span></span><br><span class="line">        x = self.Mixed_5d(x)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 3/5</span></span><br><span class="line">        <span class="comment"># N x 288 x 35 x 35</span></span><br><span class="line">        x = self.Mixed_6a(x)</span><br><span class="line">        <span class="comment"># N x 768 x 17 x 17</span></span><br><span class="line">        x = self.Mixed_6b(x)</span><br><span class="line">        <span class="comment"># N x 768 x 17 x 17</span></span><br><span class="line">        x = self.Mixed_6c(x)</span><br><span class="line">        <span class="comment"># N x 768 x 17 x 17</span></span><br><span class="line">        x = self.Mixed_6d(x)</span><br><span class="line">        <span class="comment"># N x 768 x 17 x 17</span></span><br><span class="line">        x = self.Mixed_6e(x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"># N x 768 x 17 x 17</span></span><br><span class="line">        aux_defined = self.training <span class="keyword">and</span> self.aux_logits</span><br><span class="line">        <span class="keyword">if</span> aux_defined:</span><br><span class="line">            aux = self.AuxLogits(x)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            aux = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 4/5</span></span><br><span class="line">        <span class="comment"># N x 768 x 17 x 17</span></span><br><span class="line">        x = self.Mixed_7a(x)</span><br><span class="line">        <span class="comment"># N x 1280 x 8 x 8</span></span><br><span class="line">        x = self.Mixed_7b(x)</span><br><span class="line">        <span class="comment"># N x 2048 x 8 x 8</span></span><br><span class="line">        x = self.Mixed_7c(x)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 5/5</span></span><br><span class="line">        <span class="comment"># N x 2048 x 8 x 8</span></span><br><span class="line">        <span class="comment"># Adaptive average pooling</span></span><br><span class="line">        x = F.adaptive_avg_pool2d(x, (<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">        <span class="comment"># N x 2048 x 1 x 1</span></span><br><span class="line">        x = F.dropout(x, training=self.training)</span><br><span class="line">        <span class="comment"># N x 2048 x 1 x 1</span></span><br><span class="line">        x = torch.flatten(x, <span class="number">1</span>)</span><br><span class="line">        <span class="comment"># N x 2048</span></span><br><span class="line">        x = self.fc(x)</span><br><span class="line">        <span class="comment"># N x 1000 (num_classes)</span></span><br><span class="line">        <span class="keyword">return</span> x, aux</span><br></pre></td></tr></tbody></table></figure>
<p>ï¼ˆæ ¸å¿ƒï¼‰<strong>åŸºæœ¬ç»„ä»¶ï¼šInceptionAã€InceptionBã€InceptionCã€InceptionDã€InceptionEã€InceptionAuxã€BasicConv2d</strong></p>
<blockquote>
<p>InceptionA</p>
<p>ä»£ç ä¸è®ºæ–‡çš„å·®å¼‚:</p>
<p>(1) $3\times3$å·ç§¯éƒ¨åˆ†å¤šäº†1ä¸ª$3\times3$å·ç§¯ï¼›</p>
<p>(2) $5\times5$å·ç§¯å¹¶æ²¡æœ‰ç”¨2ä¸ª$3\times3$å·ç§¯æ›¿æ¢</p>
</blockquote>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/inceptionA.png" alt="inceptionA"></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">InceptionA</span>(nn.Module):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, in_channels, pool_features, conv_block=<span class="literal">None</span></span>):</span><br><span class="line">        <span class="built_in">super</span>(InceptionA, self).__init__()</span><br><span class="line">        <span class="keyword">if</span> conv_block <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            conv_block = BasicConv2d</span><br><span class="line">        self.branch1x1 = conv_block(in_channels, <span class="number">64</span>, kernel_size=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        self.branch5x5_1 = conv_block(in_channels, <span class="number">48</span>, kernel_size=<span class="number">1</span>)</span><br><span class="line">        <span class="comment"># 5*5å·ç§¯å¹¶æ²¡æœ‰ç”¨2ä¸ª3*3å·ç§¯æ›¿æ¢</span></span><br><span class="line">        self.branch5x5_2 = conv_block(<span class="number">48</span>, <span class="number">64</span>, kernel_size=<span class="number">5</span>, padding=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment">#3*3å·ç§¯éƒ¨åˆ†å¤šäº†1ä¸ª3*3å·ç§¯</span></span><br><span class="line">        self.branch3x3dbl_1 = conv_block(in_channels, <span class="number">64</span>, kernel_size=<span class="number">1</span>)</span><br><span class="line">        self.branch3x3dbl_2 = conv_block(<span class="number">64</span>, <span class="number">96</span>, kernel_size=<span class="number">3</span>, padding=<span class="number">1</span>)</span><br><span class="line">        self.branch3x3dbl_3 = conv_block(<span class="number">96</span>, <span class="number">96</span>, kernel_size=<span class="number">3</span>, padding=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">        self.branch_pool = conv_block(in_channels, pool_features, kernel_size=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">_forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        branch1x1 = self.branch1x1(x)</span><br><span class="line"></span><br><span class="line">        branch5x5 = self.branch5x5_1(x)</span><br><span class="line">        branch5x5 = self.branch5x5_2(branch5x5)</span><br><span class="line"></span><br><span class="line">        branch3x3dbl = self.branch3x3dbl_1(x)</span><br><span class="line">        branch3x3dbl = self.branch3x3dbl_2(branch3x3dbl)</span><br><span class="line">        branch3x3dbl = self.branch3x3dbl_3(branch3x3dbl)</span><br><span class="line"></span><br><span class="line">        branch_pool = F.avg_pool2d(x, kernel_size=<span class="number">3</span>, stride=<span class="number">1</span>, padding=<span class="number">1</span>)</span><br><span class="line">        branch_pool = self.branch_pool(branch_pool)</span><br><span class="line"></span><br><span class="line">        outputs = [branch1x1, branch5x5, branch3x3dbl, branch_pool]</span><br><span class="line">        <span class="keyword">return</span> outputs</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">forward</span>(<span class="params">self, x</span>):</span><br><span class="line">        outputs = self._forward(x)</span><br><span class="line">        <span class="keyword">return</span> torch.cat(outputs, <span class="number">1</span>)</span><br></pre></td></tr></tbody></table></figure>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/inceptionB.png" alt="inceptionB"></p>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/inceptionC.png" alt="inceptionC"></p>
<p><img src="/2022/07/03/GoogleNet%E7%AC%94%E8%AE%B0/inceptionE.png" alt="inceptionE"></p>
<h2 id="é™„ï¼šè®ºæ–‡åŸæ–‡"><a href="#é™„ï¼šè®ºæ–‡åŸæ–‡" class="headerlink" title="é™„ï¼šè®ºæ–‡åŸæ–‡"></a>é™„ï¼šè®ºæ–‡åŸæ–‡</h2><p>GoogleNetV1ï¼š</p>


	<div class="row">
    <embed src="GooglenetV1.pdf" width="100%" height="550" type="application/pdf">
	</div>



<p>GoogleNetV2ï¼šåŠ å…¥BNå±‚</p>


	<div class="row">
    <embed src="BN.pdf" width="100%" height="550" type="application/pdf">
	</div>



<p>GoogleNetV3ï¼šæ”¹è¿›Inceptionï¼Œæå‡ºInceptionV2ï¼ŒInceptionV3</p>


	<div class="row">
    <embed src="V3.pdf" width="100%" height="550" type="application/pdf">
	</div>



        </div>

        
            <section class="post-copyright">
                
                
                
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89/">ğŸ·ï¸è®¡ç®—æœºè§†è§‰</a>
                    
                        <a href="/tags/%E7%BC%96%E7%A8%8B/">ğŸ·ï¸ç¼–ç¨‹</a>
                    
                        <a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/">ğŸ·ï¸æ·±åº¦å­¦ä¹ </a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>Â· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
            
            <a class="next" rel="next" href="/2022/07/02/%E4%BD%BF%E7%94%A8%E8%8F%B2%E6%B6%85%E8%80%B3%E8%A1%8D%E5%B0%84%E6%A8%A1%E5%9E%8B%E8%BF%9B%E8%A1%8C%E4%BA%BA%E7%B1%BB%E5%91%BC%E5%90%B8%E6%A3%80%E6%B5%8B/">è®ºæ–‡ç¬”è®°--ä½¿ç”¨è²æ¶…è€³è¡å°„æ¨¡å‹è¿›è¡Œäººç±»å‘¼å¸æ£€æµ‹</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>Â© å°¹ç¥ºç¿” | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>

</html>